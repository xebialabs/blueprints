apiVersion: xl/v1
kind: Blueprint
metadata:
  projectName: AWS-Datalake 
  description: |
    The blueprint deploys a data lake architecture to AWS using CloudFormation.
    XL deploy does the provisioning and deployment, while XL release orchestrates everything.
    Refer https://docs.aws.amazon.com/solutions/latest/data-lake-solution
  author: XebiaLabs
  version: 1.0
parameters:
- name: S3BucketName
  description: What is the name of the S3 bucket where CloudFormation templates should be saved?
  default: data-lake
  type: Input
  pattern: "(([a-z0-9]|[a-z0-9][a-z0-9\\-]*[a-z0-9])\\.)*([a-z0-9]|[a-z0-9][a-z0-9\\-]*[a-z0-9]){3,63}"
- name: AdministratorName
  description: What is the name of the Data Lake administrator user?
  default: admin
  type: Input
  pattern : ".+"
- name: AdministratorEmail
  description: "Provide a valid email address where to send the generated Data Lake administrator credentials:"
  type: Input
  pattern: "^[_A-Za-z0-9-\\+]+(\\.[_A-Za-z0-9-]+)*@[A-Za-z0-9-]+(\\.[A-Za-z0-9]+)*(\\.[A-Za-z]{2,})$"
- name: CognitoDomain
  description: "Provide a name for the Cognito service domain (can only contain lower-case letters, numbers, and hyphens):"
  default: data-lake
  type: Input
  pattern : "[a-z0-9-]+"
- name: UseAWSCredentialsFromSystem
  type: Confirm
  description: Do you want to use AWS credentials from ~/.aws/credentials file?
  dependsOnTrue: !fn aws.credentials().IsAvailable
- name: AWSAccessKey
  type: Input
  secret: true
  description: What is the AWS Access Key ID?
  dependsOnFalse: UseAWSCredentialsFromSystem
  default: !fn aws.credentials().AccessKeyID
- name: AWSAccessSecret
  type: Input
  secret: true
  description: What is the AWS Secret Access Key?
  dependsOnFalse: UseAWSCredentialsFromSystem
  default: !fn aws.credentials().SecretAccessKey
- name: AWSRegion
  type: Select
  description: "Select the AWS region:"
  options:
    - !fn aws.regions(lambda)
  default: !fn aws.regions(lambda)[0]
